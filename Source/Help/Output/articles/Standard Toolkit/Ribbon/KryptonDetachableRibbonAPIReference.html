<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Detachable Ribbons - API Quick Reference | Krypton Standard Toolkit Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Detachable Ribbons - API Quick Reference | Krypton Standard Toolkit Documentation ">
    
    
      <link rel="shortcut icon" href="../../../Krypton.ico">
      <link rel="stylesheet" href="../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../toc.html">
      <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../Logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="detachable-ribbons---api-quick-reference">Detachable Ribbons - API Quick Reference</h1>

<h2 id="quick-start">Quick Start</h2>
<pre><code class="lang-csharp">// Enable detach functionality
kryptonRibbon.AllowDetach = true;

// Detach the ribbon
kryptonRibbon.Detach();

// Reattach the ribbon
kryptonRibbon.Reattach();

// Check state
bool isDetached = kryptonRibbon.IsDetached;
</code></pre>
<hr>
<h2 id="api-summary">API Summary</h2>
<h3 id="properties">Properties</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AllowDetach</code></td>
<td><code>bool</code></td>
<td><code>false</code></td>
<td>Enables/disables detach functionality</td>
</tr>
<tr>
<td><code>IsDetached</code></td>
<td><code>bool</code></td>
<td><code>false</code></td>
<td>Read-only: indicates if ribbon is currently detached</td>
</tr>
<tr>
<td><code>FloatingWindowText</code></td>
<td><code>string</code></td>
<td><code>&quot;Ribbon&quot;</code></td>
<td>Text displayed in the floating window title bar</td>
</tr>
<tr>
<td><code>SavePreferencesOnStateChange</code></td>
<td><code>bool</code></td>
<td><code>true</code></td>
<td>Automatically save preferences when state changes</td>
</tr>
<tr>
<td><code>ButtonSpecs</code></td>
<td><code>RibbonButtonSpecAnyCollection</code></td>
<td>-</td>
<td>Collection of custom buttons to display next to expand/collapse button</td>
</tr>
</tbody>
</table>
<h3 id="methods">Methods</h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Returns</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Detach()</code></td>
<td><code>bool</code></td>
<td>Detaches ribbon into floating window</td>
</tr>
<tr>
<td><code>Reattach()</code></td>
<td><code>bool</code></td>
<td>Reattaches ribbon to original parent</td>
</tr>
<tr>
<td><code>SaveDetachPreferences()</code></td>
<td><code>void</code></td>
<td>Saves current detach preferences (raises event)</td>
</tr>
<tr>
<td><code>LoadDetachPreferences(bool, Point?)</code></td>
<td><code>bool</code></td>
<td>Loads and restores saved preferences</td>
</tr>
</tbody>
</table>
<h3 id="events">Events</h3>
<table>
<thead>
<tr>
<th>Event</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RibbonDetached</code></td>
<td><code>EventHandler</code></td>
<td>Raised when ribbon is detached</td>
</tr>
<tr>
<td><code>RibbonReattached</code></td>
<td><code>EventHandler</code></td>
<td>Raised when ribbon is reattached</td>
</tr>
<tr>
<td><code>DetachPreferencesChanged</code></td>
<td><code>EventHandler&lt;DetachPreferencesEventArgs&gt;</code></td>
<td>Raised when preferences should be saved</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="method-details">Method Details</h2>
<h3 id="detach"><code>Detach()</code></h3>
<p><strong>Returns</strong>: <code>true</code> if successful, <code>false</code> otherwise</p>
<p><strong>Preconditions</strong>:</p>
<ul>
<li><code>AllowDetach == true</code></li>
<li>Ribbon has a parent</li>
<li>Ribbon is not already detached</li>
<li>Parent is in a Form</li>
</ul>
<p><strong>What it does</strong>:</p>
<ol>
<li>Stores original state (parent, location, size, dock)</li>
<li>Creates floating window</li>
<li>Moves ribbon to floating window</li>
<li>Disables form integration</li>
<li>Raises <code>RibbonDetached</code> event</li>
</ol>
<h3 id="reattach"><code>Reattach()</code></h3>
<p><strong>Returns</strong>: <code>true</code> if successful, <code>false</code> otherwise</p>
<p><strong>Preconditions</strong>:</p>
<ul>
<li><code>IsDetached == true</code></li>
<li>Original parent still exists</li>
</ul>
<p><strong>What it does</strong>:</p>
<ol>
<li>Removes ribbon from floating window</li>
<li>Restores original state</li>
<li>Re-enables form integration</li>
<li>Closes floating window</li>
<li>Raises <code>RibbonReattached</code> event</li>
</ol>
<hr>
<h2 id="common-patterns">Common Patterns</h2>
<h3 id="pattern-1-basic-detachreattach">Pattern 1: Basic Detach/Reattach</h3>
<pre><code class="lang-csharp">kryptonRibbon.AllowDetach = true;
kryptonRibbon.Detach();
// ... later ...
kryptonRibbon.Reattach();
</code></pre>
<h3 id="pattern-2-event-driven-ui-updates">Pattern 2: Event-Driven UI Updates</h3>
<pre><code class="lang-csharp">kryptonRibbon.RibbonDetached += (s, e) =&gt; UpdateUI();
kryptonRibbon.RibbonReattached += (s, e) =&gt; UpdateUI();
</code></pre>
<h3 id="pattern-3-preference-persistence-recommended">Pattern 3: Preference Persistence (Recommended)</h3>
<pre><code class="lang-csharp">// Hook up preference saving
kryptonRibbon.DetachPreferencesChanged += (s, e) =&gt;
{
    Properties.Settings.Default.RibbonDetached = e.IsDetached;
    if (e.FloatingWindowPosition.HasValue)
    {
        Properties.Settings.Default.RibbonFloatingX = e.FloatingWindowPosition.Value.X;
        Properties.Settings.Default.RibbonFloatingY = e.FloatingWindowPosition.Value.Y;
    }
    Properties.Settings.Default.Save();
};

// Load saved preferences on startup
bool wasDetached = Properties.Settings.Default.RibbonDetached;
Point? savedPosition = null;
if (Properties.Settings.Default.RibbonFloatingX != 0 || 
    Properties.Settings.Default.RibbonFloatingY != 0)
{
    savedPosition = new Point(
        Properties.Settings.Default.RibbonFloatingX,
        Properties.Settings.Default.RibbonFloatingY);
}
kryptonRibbon.LoadDetachPreferences(wasDetached, savedPosition);
</code></pre>
<h3 id="pattern-4-conditional-detach">Pattern 4: Conditional Detach</h3>
<pre><code class="lang-csharp">if (kryptonRibbon.AllowDetach &amp;&amp; !kryptonRibbon.IsDetached)
{
    kryptonRibbon.Detach();
}
</code></pre>
<h3 id="pattern-5-safe-reattach">Pattern 5: Safe Reattach</h3>
<pre><code class="lang-csharp">if (kryptonRibbon.IsDetached)
{
    kryptonRibbon.Reattach();
}
</code></pre>
<h3 id="pattern-6-adding-custom-buttons-to-ribbon">Pattern 6: Adding Custom Buttons to Ribbon</h3>
<pre><code class="lang-csharp">// Add a custom button next to expand/collapse button
var customButton = new ButtonSpecAny
{
    Text = &quot;Detach&quot;,
    ToolTipTitle = &quot;Detach Ribbon&quot;,
    ToolTipBody = &quot;Move ribbon to floating window&quot;,
    UniqueName = &quot;DetachButton&quot;,
    Edge = PaletteRelativeEdgeAlign.Far  // Right side
};
customButton.Click += (s, e) =&gt; kryptonRibbon.Detach();
kryptonRibbon.ButtonSpecs.Add(customButton);
</code></pre>
<hr>
<h2 id="error-handling">Error Handling</h2>
<h3 id="detach-fails">Detach Fails</h3>
<pre><code class="lang-csharp">if (!kryptonRibbon.Detach())
{
    // Check common causes:
    if (!kryptonRibbon.AllowDetach)
        // Enable AllowDetach first
    else if (kryptonRibbon.IsDetached)
        // Already detached
    else if (kryptonRibbon.Parent == null)
        // Ribbon has no parent
}
</code></pre>
<h3 id="reattach-fails">Reattach Fails</h3>
<pre><code class="lang-csharp">if (!kryptonRibbon.Reattach())
{
    // Check common causes:
    if (!kryptonRibbon.IsDetached)
        // Not currently detached
    // Original parent may have been disposed
}
</code></pre>
<hr>
<h2 id="state-management">State Management</h2>
<h3 id="preserved-state">Preserved State</h3>
<p>When detached, the following is preserved:</p>
<ul>
<li>Original parent control</li>
<li>Original location (Point)</li>
<li>Original size (Size)</li>
<li>Original dock style (DockStyle)</li>
</ul>
<h3 id="automatic-behavior">Automatic Behavior</h3>
<ul>
<li>Floating window closes → Ribbon reattaches automatically</li>
<li><code>AllowDetach = false</code> while detached → Ribbon reattaches automatically</li>
<li>Form integration disabled when detached, re-enabled when reattached</li>
</ul>
<hr>
<h2 id="visualribbonfloatingwindow">VisualRibbonFloatingWindow</h2>
<h3 id="properties-1">Properties</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Ribbon</code></td>
<td><code>KryptonRibbon?</code></td>
<td>Read-only: access to hosted ribbon</td>
</tr>
<tr>
<td><code>InternalPanel</code></td>
<td><code>KryptonPanel</code></td>
<td>Access to the internal panel for hosting controls</td>
</tr>
</tbody>
</table>
<h3 id="events-1">Events</h3>
<table>
<thead>
<tr>
<th>Event</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WindowClosing</code></td>
<td><code>EventHandler</code></td>
<td>Raised when window is closing</td>
</tr>
<tr>
<td><code>TitleBarDoubleClick</code></td>
<td><code>EventHandler</code></td>
<td>Raised when title bar is double-clicked (reattaches ribbon)</td>
</tr>
</tbody>
</table>
<h3 id="window-characteristics">Window Characteristics</h3>
<ul>
<li>Border: <code>FixedToolWindow</code></li>
<li>Taskbar: Not shown</li>
<li>Minimize/Maximize: Disabled</li>
<li>Owner: Original form</li>
<li>Title: Uses <code>FloatingWindowText</code> property (defaults to &quot;Ribbon&quot;)</li>
<li>Double-Click Title Bar: Automatically reattaches ribbon</li>
</ul>
<hr>
<h2 id="detachpreferenceseventargs">DetachPreferencesEventArgs</h2>
<h3 id="properties-2">Properties</h3>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IsDetached</code></td>
<td><code>bool</code></td>
<td>Indicates whether the ribbon is currently detached</td>
</tr>
<tr>
<td><code>FloatingWindowPosition</code></td>
<td><code>Point?</code></td>
<td>The saved position of the floating window, or null if not saved</td>
</tr>
</tbody>
</table>
<h3 id="usage">Usage</h3>
<pre><code class="lang-csharp">private void OnDetachPreferencesChanged(object? sender, DetachPreferencesEventArgs e)
{
    // Save detached state
    Properties.Settings.Default.RibbonDetached = e.IsDetached;
    
    // Save position if available
    if (e.FloatingWindowPosition.HasValue)
    {
        Properties.Settings.Default.RibbonFloatingX = e.FloatingWindowPosition.Value.X;
        Properties.Settings.Default.RibbonFloatingY = e.FloatingWindowPosition.Value.Y;
    }
    
    Properties.Settings.Default.Save();
}
</code></pre>
<hr>
<h2 id="best-practices-checklist">Best Practices Checklist</h2>
<ul>
<li>[ ] Set <code>AllowDetach</code> at design time or during initialization</li>
<li>[ ] Check <code>IsDetached</code> before calling <code>Reattach()</code></li>
<li>[ ] Use events for UI updates, not polling</li>
<li>[ ] <strong>Handle <code>DetachPreferencesChanged</code> event to save preferences</strong></li>
<li>[ ] <strong>Call <code>LoadDetachPreferences()</code> on application startup</strong></li>
<li>[ ] Perform layout updates after reattachment</li>
<li>[ ] Handle errors gracefully</li>
<li>[ ] Test with multiple monitors</li>
<li>[ ] Consider screen size when enabling feature</li>
</ul>
<hr>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="KryptonDetachableRibbon.html">Full Documentation</a> - Comprehensive guide</li>
<li><a href="https://krypton-suite.github.io/Standard-Toolkit-Online-Help/">KryptonRibbon Class</a> - Main ribbon documentation</li>
</ul>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Krypton Component Suite 2024
BSD 3-Clause License
© Component Factory Pty Ltd, 2006 - 2016, All rights reserved.</span> <span>Modifications by Peter Wagner (aka Wagnerp), Simon Coghlan (aka Smurf-IV), Giduac, Tobitege, Lesarndro, KamaniAR & Ahmed Abdelhameed et al. 2017 - 2025. All rights reserved. <a href="https://github.com/Krypton-Suite">https://github.com/Krypton-Suite</a></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
