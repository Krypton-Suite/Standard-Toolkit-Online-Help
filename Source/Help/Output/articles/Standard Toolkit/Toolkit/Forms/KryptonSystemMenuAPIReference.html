<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>KryptonSystemMenu API Reference | Krypton Standard Toolkit Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="KryptonSystemMenu API Reference | Krypton Standard Toolkit Documentation ">
    
    
      <link rel="shortcut icon" href="../../../../Krypton.ico">
      <link rel="stylesheet" href="../../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../../toc.html">
      <meta property="docfx:tocrel" content="../../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../Logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="kryptonsystemmenu-api-reference">KryptonSystemMenu API Reference</h1>

<h2 id="namespace">Namespace</h2>
<p><code>Krypton.Toolkit</code></p>
<h2 id="class-declaration">Class Declaration</h2>
<pre><code class="lang-csharp">public class KryptonSystemMenu : IKryptonSystemMenu, IDisposable
</code></pre>
<h2 id="interfaces-implemented">Interfaces Implemented</h2>
<ul>
<li><code>IKryptonSystemMenu</code></li>
<li><code>IDisposable</code></li>
</ul>
<h2 id="constructors">Constructors</h2>
<h3 id="kryptonsystemmenukryptonform-form">KryptonSystemMenu(KryptonForm form)</h3>
<pre><code class="lang-csharp">public KryptonSystemMenu(KryptonForm form)
</code></pre>
<p><strong>Description</strong>: Initializes a new instance of the KryptonSystemMenu class.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>form</code> (KryptonForm): The KryptonForm to attach the themed system menu to.</li>
</ul>
<p><strong>Exceptions</strong>:</p>
<ul>
<li><code>ArgumentNullException</code>: Thrown when <code>form</code> parameter is null.</li>
</ul>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">var systemMenu = new KryptonSystemMenu(myKryptonForm);
</code></pre>
<h2 id="properties">Properties</h2>
<h3 id="contextmenu">ContextMenu</h3>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public KryptonContextMenu ContextMenu { get; }
</code></pre>
<p><strong>Description</strong>: Gets the underlying themed context menu.</p>
<p><strong>Type</strong>: <code>KryptonContextMenu</code></p>
<p><strong>Access</strong>: Read-only</p>
<p><strong>Notes</strong>: This property provides access to the underlying menu for advanced customization.</p>
<h3 id="enabled">Enabled</h3>
<pre><code class="lang-csharp">[Category(@&quot;Behavior&quot;)]
[Description(@&quot;Enables or disables the themed system menu.&quot;)]
[DefaultValue(true)]
public bool Enabled { get; set; }
</code></pre>
<p><strong>Description</strong>: Gets or sets whether the themed system menu is enabled.</p>
<p><strong>Type</strong>: <code>bool</code></p>
<p><strong>Default Value</strong>: <code>true</code></p>
<p><strong>Notes</strong>: When disabled, the menu will not respond to show requests.</p>
<h3 id="menuitemcount">MenuItemCount</h3>
<pre><code class="lang-csharp">[Category(@&quot;Appearance&quot;)]
[Description(@&quot;The number of items currently in the themed system menu.&quot;)]
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public int MenuItemCount { get; }
</code></pre>
<p><strong>Description</strong>: Gets the number of items currently in the themed system menu.</p>
<p><strong>Type</strong>: <code>int</code></p>
<p><strong>Access</strong>: Read-only</p>
<h3 id="hasmenuitems">HasMenuItems</h3>
<pre><code class="lang-csharp">[Category(@&quot;Appearance&quot;)]
[Description(@&quot;Indicates whether the themed system menu contains any items.&quot;)]
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool HasMenuItems { get; }
</code></pre>
<p><strong>Description</strong>: Gets whether the themed system menu contains any items.</p>
<p><strong>Type</strong>: <code>bool</code></p>
<p><strong>Access</strong>: Read-only</p>
<h3 id="showonleftclick">ShowOnLeftClick</h3>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool ShowOnLeftClick { get; set; }
</code></pre>
<p><strong>Description</strong>: Gets or sets whether left-click on title bar shows the themed system menu.</p>
<p><strong>Type</strong>: <code>bool</code></p>
<p><strong>Default Value</strong>: <code>true</code></p>
<h3 id="showonrightclick">ShowOnRightClick</h3>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool ShowOnRightClick { get; set; }
</code></pre>
<p><strong>Description</strong>: Gets or sets whether right-click on title bar shows the themed system menu.</p>
<p><strong>Type</strong>: <code>bool</code></p>
<p><strong>Default Value</strong>: <code>true</code></p>
<h3 id="showonaltspace">ShowOnAltSpace</h3>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool ShowOnAltSpace { get; set; }
</code></pre>
<p><strong>Description</strong>: Gets or sets whether Alt+Space shows the themed system menu.</p>
<p><strong>Type</strong>: <code>bool</code></p>
<p><strong>Default Value</strong>: <code>true</code></p>
<h3 id="currenticontheme">CurrentIconTheme</h3>
<pre><code class="lang-csharp">[Category(@&quot;Appearance&quot;)]
[Description(@&quot;The current theme name being used for system menu icons.&quot;)]
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public string CurrentIconTheme { get; }
</code></pre>
<p><strong>Description</strong>: Gets the current theme name being used for system menu icons.</p>
<p><strong>Type</strong>: <code>string</code></p>
<p><strong>Access</strong>: Read-only</p>
<p><strong>Return Values</strong>:</p>
<ul>
<li>&quot;Office2013&quot;</li>
<li>&quot;Office2010&quot;</li>
<li>&quot;Office2007&quot;</li>
<li>&quot;Sparkle&quot;</li>
<li>&quot;Professional&quot;</li>
<li>&quot;Microsoft365&quot;</li>
<li>&quot;Office2003&quot;</li>
</ul>
<h2 id="methods">Methods</h2>
<h3 id="showpoint-screenlocation">Show(Point screenLocation)</h3>
<pre><code class="lang-csharp">public void Show(Point screenLocation)
</code></pre>
<p><strong>Description</strong>: Shows the themed system menu at the specified screen location.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>screenLocation</code> (Point): The screen coordinates where to show the menu.</li>
</ul>
<p><strong>Returns</strong>: <code>void</code></p>
<p><strong>Notes</strong>: The position is automatically adjusted to ensure the menu stays within screen bounds.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">systemMenu.Show(new Point(100, 100));
</code></pre>
<h3 id="showatformtopleft">ShowAtFormTopLeft()</h3>
<pre><code class="lang-csharp">public void ShowAtFormTopLeft()
</code></pre>
<p><strong>Description</strong>: Shows the themed system menu at the top-left corner of the form.</p>
<p><strong>Returns</strong>: <code>void</code></p>
<p><strong>Notes</strong>: Mimics the native system menu behavior.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">systemMenu.ShowAtFormTopLeft();
</code></pre>
<h3 id="refresh">Refresh()</h3>
<pre><code class="lang-csharp">public void Refresh()
</code></pre>
<p><strong>Description</strong>: Refreshes the system menu items based on current form state.</p>
<p><strong>Returns</strong>: <code>void</code></p>
<p><strong>Notes</strong>: This method rebuilds the menu structure, updates menu item states, and refreshes icons.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">systemMenu.Refresh();
</code></pre>
<h3 id="handlekeyboardshortcutkeys-keydata">HandleKeyboardShortcut(Keys keyData)</h3>
<pre><code class="lang-csharp">public bool HandleKeyboardShortcut(Keys keyData)
</code></pre>
<p><strong>Description</strong>: Handles keyboard shortcuts for system menu actions.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>keyData</code> (Keys): The key combination pressed.</li>
</ul>
<p><strong>Returns</strong>: <code>bool</code> - <code>true</code> if the shortcut was handled; otherwise <code>false</code>.</p>
<p><strong>Supported Shortcuts</strong>:</p>
<ul>
<li><code>Alt+F4</code>: Close the form</li>
<li><code>Alt+Space</code>: Show the system menu (if enabled)</li>
</ul>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">if (systemMenu.HandleKeyboardShortcut(Keys.Alt | Keys.F4))
{
    // Shortcut was handled
}
</code></pre>
<h3 id="getcurrenttheme">GetCurrentTheme()</h3>
<pre><code class="lang-csharp">public string GetCurrentTheme()
</code></pre>
<p><strong>Description</strong>: Determines the current theme based on the form's palette.</p>
<p><strong>Returns</strong>: <code>string</code> - The current theme name.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">var theme = systemMenu.GetCurrentTheme();
Console.WriteLine($&quot;Current theme: {theme}&quot;);
</code></pre>
<h3 id="refreshthemeicons">RefreshThemeIcons()</h3>
<pre><code class="lang-csharp">public void RefreshThemeIcons()
</code></pre>
<p><strong>Description</strong>: Manually refreshes all icons to match the current theme.</p>
<p><strong>Returns</strong>: <code>void</code></p>
<p><strong>Notes</strong>: Call this method when the application theme changes.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">systemMenu.RefreshThemeIcons();
</code></pre>
<h3 id="seticonthemestring-themename">SetIconTheme(string themeName)</h3>
<pre><code class="lang-csharp">public void SetIconTheme(string themeName)
</code></pre>
<p><strong>Description</strong>: Manually sets the theme for icon selection.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>themeName</code> (string): The theme name to use for icons.</li>
</ul>
<p><strong>Returns</strong>: <code>void</code></p>
<p><strong>Notes</strong>: If <code>themeName</code> is null or empty, the method returns without action.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">systemMenu.SetIconTheme(&quot;Office2010&quot;);
</code></pre>
<h3 id="setthemetypethemetype-themetype">SetThemeType(ThemeType themeType)</h3>
<pre><code class="lang-csharp">public void SetThemeType(ThemeType themeType)
</code></pre>
<p><strong>Description</strong>: Sets the theme based on specific theme types.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>themeType</code> (ThemeType): The theme type to use.</li>
</ul>
<p><strong>Returns</strong>: <code>void</code></p>
<p><strong>ThemeType Values</strong>:</p>
<ul>
<li><code>ThemeType.Black</code> → &quot;Office2013&quot;</li>
<li><code>ThemeType.Blue</code> → &quot;Office2010&quot;</li>
<li><code>ThemeType.Silver</code> → &quot;Office2013&quot;</li>
<li><code>ThemeType.DarkBlue</code> → &quot;Office2010&quot;</li>
<li><code>ThemeType.LightBlue</code> → &quot;Office2010&quot;</li>
<li><code>ThemeType.WarmSilver</code> → &quot;Office2013&quot;</li>
<li><code>ThemeType.ClassicSilver</code> → &quot;Office2007&quot;</li>
</ul>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">systemMenu.SetThemeType(ThemeType.Office2010Blue);
</code></pre>
<h2 id="ikryptonsystemmenu-interface">IKryptonSystemMenu Interface</h2>
<p>The <code>KryptonSystemMenu</code> implements the <code>IKryptonSystemMenu</code> interface, which defines the contract for system menu functionality.</p>
<h3 id="interface-members">Interface Members</h3>
<h4 id="properties-1">Properties</h4>
<ul>
<li><code>bool Enabled { get; set; }</code></li>
<li><code>bool ShowOnLeftClick { get; set; }</code></li>
<li><code>bool ShowOnRightClick { get; set; }</code></li>
<li><code>bool ShowOnAltSpace { get; set; }</code></li>
<li><code>string CurrentIconTheme { get; }</code></li>
</ul>
<h4 id="methods-1">Methods</h4>
<ul>
<li><code>void Show(Point screenLocation)</code></li>
<li><code>void ShowAtFormTopLeft()</code></li>
<li><code>void Refresh()</code></li>
<li><code>bool HandleKeyboardShortcut(Keys keyData)</code></li>
</ul>
<h2 id="idisposable-implementation">IDisposable Implementation</h2>
<p>The <code>KryptonSystemMenu</code> implements <code>IDisposable</code> for proper resource management.</p>
<h3 id="dispose">Dispose()</h3>
<pre><code class="lang-csharp">public void Dispose()
</code></pre>
<p><strong>Description</strong>: Releases all resources used by the KryptonSystemMenu.</p>
<p><strong>Example</strong>:</p>
<pre><code class="lang-csharp">using (var systemMenu = new KryptonSystemMenu(form))
{
    // Use the system menu
}
// Automatically disposed
</code></pre>
<h3 id="disposebool-disposing">Dispose(bool disposing)</h3>
<pre><code class="lang-csharp">protected virtual void Dispose(bool disposing)
</code></pre>
<p><strong>Description</strong>: Releases the unmanaged resources used by the KryptonSystemMenu and optionally releases the managed resources.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>disposing</code> (bool): True to release both managed and unmanaged resources; false to release only unmanaged resources.</li>
</ul>
<h2 id="enumerations">Enumerations</h2>
<h3 id="systemmenuicontype">SystemMenuIconType</h3>
<pre><code class="lang-csharp">public enum SystemMenuIconType
{
    Restore,
    Minimize,
    Maximize,
    Close,
    Move,
    Size
}
</code></pre>
<p><strong>Description</strong>: Defines the types of system menu icons.</p>
<h3 id="themetype">ThemeType</h3>
<pre><code class="lang-csharp">public enum ThemeType
{
    Black,
    Blue,
    Silver,
    DarkBlue,
    LightBlue,
    WarmSilver,
    ClassicSilver
}
</code></pre>
<p><strong>Description</strong>: Defines the available theme types for icon selection.</p>
<h2 id="events">Events</h2>
<p>The <code>KryptonSystemMenu</code> class does not expose public events directly. Event handling is managed internally through the underlying <code>KryptonContextMenu</code> and its menu items.</p>
<h3 id="internal-event-handling">Internal Event Handling</h3>
<p>Menu item click events are handled internally:</p>
<pre><code class="lang-csharp">// Internal event handlers (not publicly accessible)
private void OnRestoreItemOnClick(object? sender, EventArgs e)
private void OnMinimizeItemOnClick(object? sender, EventArgs e)
private void OnMaximizeItemOnClick(object? sender, EventArgs e)
private void OnCloseItemOnClick(object? sender, EventArgs e)
</code></pre>
<h2 id="dependencies">Dependencies</h2>
<h3 id="required-assemblies">Required Assemblies</h3>
<ul>
<li><code>Krypton.Toolkit.dll</code></li>
<li><code>System.Drawing.dll</code></li>
<li><code>System.Windows.Forms.dll</code></li>
</ul>
<h3 id="required-types">Required Types</h3>
<ul>
<li><code>KryptonForm</code></li>
<li><code>KryptonContextMenu</code></li>
<li><code>SystemMenuImageResources</code></li>
<li><code>KryptonManager.Strings.SystemMenuStrings</code></li>
</ul>
<h2 id="thread-safety">Thread Safety</h2>
<p>The <code>KryptonSystemMenu</code> class is not thread-safe. All operations must be performed on the UI thread.</p>
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="KryptonSystemMenuDeveloperGuide.html">KryptonSystemMenu Developer Guide</a></li>
<li><a href="KryptonFormAPIReference.html">KryptonForm Class Reference</a></li>
<li><a href="./KryptonContextMenuAPIReference.md">KryptonContextMenu Class Reference</a></li>
</ul>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Krypton Component Suite 2024
BSD 3-Clause License
© Component Factory Pty Ltd, 2006 - 2016, All rights reserved.</span> <span>Modifications by Peter Wagner (aka Wagnerp), Simon Coghlan (aka Smurf-IV), Giduac, Tobitege, Lesarndro, KamaniAR & Ahmed Abdelhameed et al. 2017 - 2025. All rights reserved. <a href="https://github.com/Krypton-Suite">https://github.com/Krypton-Suite</a></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
