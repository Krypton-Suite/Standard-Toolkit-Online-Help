<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>KryptonThemedSystemMenu API Documentation | Krypton Standard Toolkit Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="KryptonThemedSystemMenu API Documentation | Krypton Standard Toolkit Documentation ">
    
    
      <link rel="shortcut icon" href="../../../Krypton.ico">
      <link rel="stylesheet" href="../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../toc.html">
      <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../Logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="kryptonthemedsystemmenu-api-documentation">KryptonThemedSystemMenu API Documentation</h1>

<h2 id="overview">Overview</h2>
<p>The KryptonThemedSystemMenu system provides a comprehensive solution for replacing the native Windows system menu with a themed <code>KryptonContextMenu</code> that seamlessly integrates with the Krypton Toolkit's theming system. This implementation offers full customization capabilities while maintaining native functionality and performance.</p>
<h2 id="architecture">Architecture</h2>
<p>The themed system menu implementation consists of several interconnected components:</p>
<h3 id="core-components">Core Components</h3>
<ol>
<li><strong>KryptonThemedSystemMenu</strong> - Main class that manages the themed system menu</li>
<li><strong>KryptonThemedSystemMenuService</strong> - Service wrapper for easy form integration</li>
<li><strong>IKryptonThemedSystemMenu</strong> - Interface defining the contract for themed system menu functionality</li>
<li><strong>KryptonThemedSystemMenuConverter</strong> - Type converter for design-time support</li>
</ol>
<h2 id="api-reference">API Reference</h2>
<h3 id="1-kryptonthemedsystemmenu-class">1. KryptonThemedSystemMenu Class</h3>
<p><strong>Location</strong>: <code>Source/Krypton Components/Krypton.Toolkit/Controls Toolkit/KryptonThemedSystemMenu.cs</code></p>
<p>The main class that provides themed system menu functionality.</p>
<h4 id="constructor">Constructor</h4>
<pre><code class="lang-csharp">public KryptonThemedSystemMenu(Form form)
</code></pre>
<ul>
<li><strong>Parameters</strong>: <code>form</code> - The form to attach the themed system menu to</li>
<li><strong>Throws</strong>: <code>ArgumentNullException</code> if form is null</li>
</ul>
<h4 id="properties">Properties</h4>
<h5 id="contextmenu">ContextMenu</h5>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public KryptonContextMenu ContextMenu { get; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets the themed context menu instance</li>
<li><strong>Access</strong>: Read-only</li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="designermenuitems">DesignerMenuItems</h5>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public ThemedSystemMenuItemCollection? DesignerMenuItems { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets or sets designer-configured menu items</li>
<li><strong>Access</strong>: Read/Write</li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="enabled">Enabled</h5>
<pre><code class="lang-csharp">[Category(&quot;Behavior&quot;)]
[Description(&quot;Enables or disables the themed system menu.&quot;)]
[DefaultValue(true)]
public bool Enabled { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Controls whether the themed system menu is active</li>
<li><strong>Default</strong>: <code>true</code></li>
<li><strong>Design-time</strong>: Visible in property grid</li>
</ul>
<h5 id="menuitemcount">MenuItemCount</h5>
<pre><code class="lang-csharp">[Category(&quot;Appearance&quot;)]
[Description(&quot;The number of items currently in the themed system menu.&quot;)]
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public int MenuItemCount { get; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets the number of items in the themed system menu</li>
<li><strong>Access</strong>: Read-only</li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="hasmenuitems">HasMenuItems</h5>
<pre><code class="lang-csharp">[Category(&quot;Appearance&quot;)]
[Description(&quot;Indicates whether the themed system menu contains any items.&quot;)]
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool HasMenuItems { get; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets whether the menu has been populated with items</li>
<li><strong>Access</strong>: Read-only</li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="showonleftclick">ShowOnLeftClick</h5>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool ShowOnLeftClick { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Controls whether left-click on title bar shows the themed system menu</li>
<li><strong>Default</strong>: <code>true</code></li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="showonrightclick">ShowOnRightClick</h5>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool ShowOnRightClick { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Controls whether right-click on title bar shows the themed system menu</li>
<li><strong>Default</strong>: <code>true</code></li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="showonaltspace">ShowOnAltSpace</h5>
<pre><code class="lang-csharp">[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public bool ShowOnAltSpace { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Controls whether Alt+Space shows the themed system menu</li>
<li><strong>Default</strong>: <code>true</code></li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h5 id="currenticontheme">CurrentIconTheme</h5>
<pre><code class="lang-csharp">[Category(&quot;Appearance&quot;)]
[Description(&quot;The current theme name being used for system menu icons.&quot;)]
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public string CurrentIconTheme { get; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets the current theme name being used for icons</li>
<li><strong>Access</strong>: Read-only</li>
<li><strong>Design-time</strong>: Hidden from designer</li>
</ul>
<h4 id="methods">Methods</h4>
<h5 id="show">Show</h5>
<pre><code class="lang-csharp">public void Show(Point screenLocation)
</code></pre>
<ul>
<li><strong>Parameters</strong>: <code>screenLocation</code> - The screen coordinates where to show the menu</li>
<li><strong>Description</strong>: Shows the themed system menu at the specified location</li>
<li><strong>Behavior</strong>: Automatically adjusts position to ensure menu is fully visible</li>
</ul>
<h5 id="showatformtopleft">ShowAtFormTopLeft</h5>
<pre><code class="lang-csharp">public void ShowAtFormTopLeft()
</code></pre>
<ul>
<li><strong>Description</strong>: Shows the themed system menu at the top-left corner of the form</li>
<li><strong>Behavior</strong>: Positions menu like the native system menu</li>
</ul>
<h5 id="refresh">Refresh</h5>
<pre><code class="lang-csharp">public void Refresh()
</code></pre>
<ul>
<li><strong>Description</strong>: Refreshes the system menu items based on current form state</li>
<li><strong>Behavior</strong>: Rebuilds menu, updates item states, and refreshes icons</li>
</ul>
<h5 id="handlekeyboardshortcut">HandleKeyboardShortcut</h5>
<pre><code class="lang-csharp">public bool HandleKeyboardShortcut(Keys keyData)
</code></pre>
<ul>
<li><strong>Parameters</strong>: <code>keyData</code> - The key combination pressed</li>
<li><strong>Returns</strong>: <code>true</code> if the shortcut was handled; otherwise <code>false</code></li>
<li><strong>Description</strong>: Handles keyboard shortcuts for system menu actions</li>
<li><strong>Supported Shortcuts</strong>:
<ul>
<li><code>Alt+F4</code> - Close form</li>
<li><code>Alt+Space</code> - Show system menu</li>
</ul>
</li>
</ul>
<h5 id="addcustommenuitem">AddCustomMenuItem</h5>
<pre><code class="lang-csharp">public void AddCustomMenuItem(string text, EventHandler? clickHandler, bool insertBeforeClose = true)
</code></pre>
<ul>
<li><strong>Parameters</strong>:
<ul>
<li><code>text</code> - The text to display for the menu item</li>
<li><code>clickHandler</code> - The action to execute when the item is clicked</li>
<li><code>insertBeforeClose</code> - If true, inserts before Close item; otherwise at end</li>
</ul>
</li>
<li><strong>Description</strong>: Adds a custom menu item to the system menu</li>
<li><strong>Behavior</strong>: Automatically adds separators as needed</li>
</ul>
<h5 id="addseparator">AddSeparator</h5>
<pre><code class="lang-csharp">public void AddSeparator(bool insertBeforeClose = true)
</code></pre>
<ul>
<li><strong>Parameters</strong>: <code>insertBeforeClose</code> - If true, inserts before Close item; otherwise at end</li>
<li><strong>Description</strong>: Adds a separator to the themed system menu</li>
</ul>
<h5 id="clearcustomitems">ClearCustomItems</h5>
<pre><code class="lang-csharp">public void ClearCustomItems()
</code></pre>
<ul>
<li><strong>Description</strong>: Clears all custom items from the themed system menu</li>
<li><strong>Behavior</strong>: Preserves standard system menu items</li>
</ul>
<h5 id="getcustommenuitems">GetCustomMenuItems</h5>
<pre><code class="lang-csharp">public List&lt;string&gt; GetCustomMenuItems()
</code></pre>
<ul>
<li><strong>Returns</strong>: List of custom menu item texts</li>
<li><strong>Description</strong>: Gets a list of custom menu item texts</li>
</ul>
<h5 id="refreshthemeicons">RefreshThemeIcons</h5>
<pre><code class="lang-csharp">public void RefreshThemeIcons()
</code></pre>
<ul>
<li><strong>Description</strong>: Manually refreshes all icons to match the current theme</li>
<li><strong>Usage</strong>: Call when application theme changes</li>
</ul>
<h3 id="2-kryptonthemedsystemmenuservice-class">2. KryptonThemedSystemMenuService Class</h3>
<p><strong>Location</strong>: <code>Source/Krypton Components/Krypton.Toolkit/General/KryptonThemedSystemMenuService.cs</code></p>
<p>A service wrapper that provides easy integration with forms and manages the lifecycle of the themed system menu.</p>
<h4 id="constructor-1">Constructor</h4>
<pre><code class="lang-csharp">public KryptonThemedSystemMenuService(Form form)
</code></pre>
<ul>
<li><strong>Parameters</strong>: <code>form</code> - The form to attach the themed system menu to</li>
<li><strong>Throws</strong>: <code>ArgumentNullException</code> if form is null</li>
</ul>
<h4 id="properties-1">Properties</h4>
<h5 id="usethemedsystemmenu">UseThemedSystemMenu</h5>
<pre><code class="lang-csharp">public bool UseThemedSystemMenu { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets or sets whether the themed system menu is enabled</li>
<li><strong>Access</strong>: Read/Write</li>
</ul>
<h5 id="showthemedsystemmenuonleftclick">ShowThemedSystemMenuOnLeftClick</h5>
<pre><code class="lang-csharp">public bool ShowThemedSystemMenuOnLeftClick { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets or sets whether to show the themed system menu on left click</li>
<li><strong>Access</strong>: Read/Write</li>
</ul>
<h5 id="showthemedsystemmenuonrightclick">ShowThemedSystemMenuOnRightClick</h5>
<pre><code class="lang-csharp">public bool ShowThemedSystemMenuOnRightClick { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets or sets whether to show the themed system menu on right click</li>
<li><strong>Access</strong>: Read/Write</li>
</ul>
<h5 id="showthemedsystemmenuonaltspace">ShowThemedSystemMenuOnAltSpace</h5>
<pre><code class="lang-csharp">public bool ShowThemedSystemMenuOnAltSpace { get; set; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets or sets whether to show the themed system menu on Alt+Space</li>
<li><strong>Access</strong>: Read/Write</li>
</ul>
<h5 id="themedsystemmenu">ThemedSystemMenu</h5>
<pre><code class="lang-csharp">public KryptonThemedSystemMenu ThemedSystemMenu { get; }
</code></pre>
<ul>
<li><strong>Description</strong>: Gets the themed system menu instance for advanced customization</li>
<li><strong>Access</strong>: Read-only</li>
</ul>
<h4 id="methods-1">Methods</h4>
<h5 id="dispose">Dispose</h5>
<pre><code class="lang-csharp">public void Dispose()
</code></pre>
<ul>
<li><strong>Description</strong>: Releases all resources used by the service</li>
<li><strong>Implementation</strong>: Implements IDisposable pattern</li>
</ul>
<h5 id="disposebool-disposing">Dispose(bool disposing)</h5>
<pre><code class="lang-csharp">protected virtual void Dispose(bool disposing)
</code></pre>
<ul>
<li><strong>Parameters</strong>: <code>disposing</code> - True if called from Dispose(); false if called from finalizer</li>
<li><strong>Description</strong>: Releases managed and unmanaged resources</li>
</ul>
<h3 id="3-ikryptonthemedsystemmenu-interface">3. IKryptonThemedSystemMenu Interface</h3>
<p><strong>Location</strong>: <code>Source/Krypton Components/Krypton.Toolkit/General/Definitions.cs</code></p>
<p>Defines the contract for themed system menu functionality.</p>
<h4 id="properties-2">Properties</h4>
<ul>
<li><code>bool Enabled { get; set; }</code> - Controls whether the themed system menu is enabled</li>
<li><code>bool ShowOnLeftClick { get; set; }</code> - Controls left-click trigger</li>
<li><code>bool ShowOnRightClick { get; set; }</code> - Controls right-click trigger</li>
<li><code>bool ShowOnAltSpace { get; set; }</code> - Controls Alt+Space trigger</li>
<li><code>int MenuItemCount { get; }</code> - Number of items in the menu</li>
<li><code>bool HasMenuItems { get; }</code> - Whether menu contains items</li>
<li><code>string CurrentIconTheme { get; }</code> - Current theme name for icons</li>
</ul>
<h4 id="methods-2">Methods</h4>
<ul>
<li><code>void Show(Point screenLocation)</code> - Show menu at specified location</li>
<li><code>void ShowAtFormTopLeft()</code> - Show menu at form's top-left</li>
<li><code>void Refresh()</code> - Refresh the menu</li>
<li><code>bool HandleKeyboardShortcut(Keys keyData)</code> - Handle keyboard shortcuts</li>
<li><code>void AddCustomMenuItem(string text, EventHandler? clickHandler, bool insertBeforeClose)</code> - Add custom item</li>
<li><code>void AddSeparator(bool insertBeforeClose)</code> - Add separator</li>
<li><code>void ClearCustomItems()</code> - Clear custom items</li>
<li><code>List&lt;string&gt; GetCustomMenuItems()</code> - Get custom item texts</li>
<li><code>void RefreshThemeIcons()</code> - Refresh theme icons</li>
</ul>
<h3 id="4-kryptonthemedsystemmenuconverter-class">4. KryptonThemedSystemMenuConverter Class</h3>
<p><strong>Location</strong>: <code>Source/Krypton Components/Krypton.Toolkit/Converters/KryptonThemedSystemMenuConverter.cs</code></p>
<p>Provides type conversion support for design-time integration.</p>
<h4 id="constructor-2">Constructor</h4>
<pre><code class="lang-csharp">public KryptonThemedSystemMenuConverter()
</code></pre>
<h4 id="methods-3">Methods</h4>
<ul>
<li><code>CanConvertTo(ITypeDescriptorContext? context, Type? destinationType)</code> - Check if conversion is possible</li>
<li><code>ConvertTo(ITypeDescriptorContext? context, CultureInfo? culture, object? value, Type destinationType)</code> - Perform conversion</li>
</ul>
<h2 id="integration-with-kryptonform">Integration with KryptonForm</h2>
<h3 id="automatic-integration">Automatic Integration</h3>
<p>The <code>KryptonForm</code> class automatically integrates with the themed system menu:</p>
<pre><code class="lang-csharp">// KryptonForm automatically creates the service
private readonly KryptonThemedSystemMenuService? _themedSystemMenuService;

// Service is initialized in constructor
_themedSystemMenuService = new KryptonThemedSystemMenuService(this);

// Property provides access to the themed system menu
public override IKryptonThemedSystemMenu? KryptonSystemMenu =&gt; _themedSystemMenuService?.ThemedSystemMenu;
</code></pre>
<h3 id="properties-available-on-kryptonform">Properties Available on KryptonForm</h3>
<ul>
<li><code>UseThemedSystemMenu</code> - Enable/disable themed system menu</li>
<li><code>ShowThemedSystemMenuOnLeftClick</code> - Control left-click trigger</li>
<li><code>ShowThemedSystemMenuOnRightClick</code> - Control right-click trigger</li>
<li><code>ShowThemedSystemMenuOnAltSpace</code> - Control Alt+Space trigger</li>
<li><code>KryptonSystemMenu</code> - Access to themed system menu instance</li>
</ul>
<h2 id="usage-examples">Usage Examples</h2>
<h3 id="1-basic-usage-automatic">1. Basic Usage (Automatic)</h3>
<pre><code class="lang-csharp">// Create a KryptonForm - themed system menu is automatically enabled
var form = new KryptonForm();
form.Text = &quot;My Application&quot;;

// The themed system menu will work automatically
// Users can trigger it by:
// - Left-clicking on the title bar
// - Right-clicking on the title bar
// - Pressing Alt+Space
</code></pre>
<h3 id="2-configuration">2. Configuration</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Configure trigger methods
form.ShowThemedSystemMenuOnLeftClick = true;    // Enable left-click
form.ShowThemedSystemMenuOnRightClick = true;   // Enable right-click
form.ShowThemedSystemMenuOnAltSpace = true;     // Enable Alt+Space

// Disable specific triggers
form.ShowThemedSystemMenuOnLeftClick = false;   // Disable left-click only
</code></pre>
<h3 id="3-custom-menu-items">3. Custom Menu Items</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Add custom menu items
if (form.KryptonSystemMenu != null)
{
    // Add a custom item before the Close item
    form.KryptonSystemMenu.AddCustomMenuItem(&quot;Custom Action&quot;, (sender, e) =&gt;
    {
        MessageBox.Show(&quot;Custom action executed!&quot;);
    }, insertBeforeClose: true);

    // Add a separator
    form.KryptonSystemMenu.AddSeparator(insertBeforeClose: true);

    // Add another custom item
    form.KryptonSystemMenu.AddCustomMenuItem(&quot;Settings&quot;, (sender, e) =&gt;
    {
        // Open settings dialog
        OpenSettingsDialog();
    }, insertBeforeClose: true);
}
</code></pre>
<h3 id="4-advanced-customization">4. Advanced Customization</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Get direct access to the context menu for advanced customization
if (form.KryptonSystemMenu is KryptonThemedSystemMenu themedMenu)
{
    // Access the underlying KryptonContextMenu
    var contextMenu = themedMenu.ContextMenu;

    // Add custom items with full control
    var customItem = new KryptonContextMenuItem(&quot;Advanced Action&quot;);
    customItem.Click += (sender, e) =&gt; PerformAdvancedAction();
    
    // Add to the end of the menu
    contextMenu.Items.Add(new KryptonContextMenuSeparator());
    contextMenu.Items.Add(customItem);
}
</code></pre>
<h3 id="5-keyboard-shortcut-handling">5. Keyboard Shortcut Handling</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Override ProcessCmdKey to handle additional shortcuts
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    // Let the themed system menu handle its shortcuts first
    if (KryptonSystemMenu?.HandleKeyboardShortcut(keyData) == true)
    {
        return true;
    }

    // Handle your own shortcuts
    if (keyData == (Keys.Control | Keys.S))
    {
        SaveDocument();
        return true;
    }

    return base.ProcessCmdKey(ref msg, keyData);
}
</code></pre>
<h3 id="6-theme-aware-icons">6. Theme-Aware Icons</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Refresh icons when theme changes
KryptonManager.GlobalPaletteChanged += (sender, e) =&gt;
{
    if (form.KryptonSystemMenu != null)
    {
        form.KryptonSystemMenu.RefreshThemeIcons();
    }
};
</code></pre>
<h3 id="7-conditional-menu-items">7. Conditional Menu Items</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Add conditional menu items based on application state
if (form.KryptonSystemMenu != null)
{
    // Only show &quot;Save&quot; if document is modified
    if (IsDocumentModified)
    {
        form.KryptonSystemMenu.AddCustomMenuItem(&quot;Save&quot;, (sender, e) =&gt; SaveDocument());
    }

    // Only show &quot;Print&quot; if printer is available
    if (IsPrinterAvailable)
    {
        form.KryptonSystemMenu.AddCustomMenuItem(&quot;Print&quot;, (sender, e) =&gt; PrintDocument());
    }
}
</code></pre>
<h3 id="8-disabling-themed-system-menu">8. Disabling Themed System Menu</h3>
<pre><code class="lang-csharp">var form = new KryptonForm();

// Completely disable themed system menu (falls back to native)
form.UseThemedSystemMenu = false;

// Or disable specific triggers while keeping others
form.ShowThemedSystemMenuOnLeftClick = false;   // Disable left-click
form.ShowThemedSystemMenuOnRightClick = false;  // Disable right-click
// Alt+Space still works
</code></pre>
<h2 id="system-menu-items">System Menu Items</h2>
<h3 id="standard-items">Standard Items</h3>
<p>The themed system menu automatically includes these standard items:</p>
<ol>
<li><strong>Restore</strong> - Restore window from minimized/maximized state</li>
<li><strong>Move</strong> - Allow window to be moved</li>
<li><strong>Size</strong> - Allow window to be resized</li>
<li><strong>Minimize</strong> - Minimize the window</li>
<li><strong>Maximize</strong> - Maximize the window</li>
<li><strong>Close</strong> - Close the window</li>
</ol>
<h3 id="dynamic-state">Dynamic State</h3>
<p>Menu items are automatically enabled/disabled based on the current window state:</p>
<ul>
<li><strong>Restore</strong>: Enabled when window is minimized or maximized</li>
<li><strong>Move</strong>: Enabled when window is not maximized</li>
<li><strong>Size</strong>: Enabled when window is not maximized and is resizable</li>
<li><strong>Minimize</strong>: Enabled when window is not minimized</li>
<li><strong>Maximize</strong>: Enabled when window is not maximized and can be maximized</li>
<li><strong>Close</strong>: Always enabled</li>
</ul>
<h2 id="performance-considerations">Performance Considerations</h2>
<h3 id="resource-management">Resource Management</h3>
<ul>
<li><strong>Lazy Loading</strong>: Menu items are built only when needed</li>
<li><strong>Disposal</strong>: Proper resource cleanup through IDisposable implementation</li>
<li><strong>Memory Efficiency</strong>: Minimal memory footprint when not in use</li>
</ul>
<h3 id="optimization-tips">Optimization Tips</h3>
<ol>
<li><strong>Avoid Frequent Refreshes</strong>: Only call <code>Refresh()</code> when necessary</li>
<li><strong>Batch Custom Items</strong>: Add multiple items at once rather than individually</li>
<li><strong>Theme Changes</strong>: Use <code>RefreshThemeIcons()</code> instead of full <code>Refresh()</code> for theme changes</li>
<li><strong>Disposal</strong>: Always dispose of custom event handlers when removing items</li>
</ol>
<h2 id="error-handling">Error Handling</h2>
<h3 id="graceful-degradation">Graceful Degradation</h3>
<p>The implementation includes multiple fallback mechanisms:</p>
<ol>
<li><strong>Native Menu Parsing</strong>: If native system menu cannot be parsed, a basic themed menu is created</li>
<li><strong>Exception Handling</strong>: All operations are wrapped in try-catch blocks</li>
<li><strong>Null Checks</strong>: Comprehensive null checking prevents crashes</li>
<li><strong>Resource Cleanup</strong>: Proper disposal prevents resource leaks</li>
</ol>
<h3 id="common-scenarios">Common Scenarios</h3>
<pre><code class="lang-csharp">// Safe access to themed system menu
if (form.KryptonSystemMenu != null)
{
    try
    {
        form.KryptonSystemMenu.AddCustomMenuItem(&quot;Safe Action&quot;, (sender, e) =&gt;
        {
            // Your action here
        });
    }
    catch (Exception ex)
    {
        // Handle any errors gracefully
        Debug.WriteLine($&quot;Failed to add custom menu item: {ex.Message}&quot;);
    }
}
</code></pre>
<h2 id="design-time-support">Design-Time Support</h2>
<h3 id="property-grid-integration">Property Grid Integration</h3>
<p>The themed system menu properties are fully integrated with the Visual Studio property grid:</p>
<ul>
<li><strong>Enabled</strong>: Boolean property with category &quot;Behavior&quot;</li>
<li><strong>ShowOnLeftClick</strong>: Boolean property (design-time only)</li>
<li><strong>ShowOnRightClick</strong>: Boolean property (design-time only)</li>
<li><strong>ShowOnAltSpace</strong>: Boolean property (design-time only)</li>
</ul>
<h3 id="type-converter">Type Converter</h3>
<p>The <code>KryptonThemedSystemMenuConverter</code> provides:</p>
<ul>
<li><strong>String Conversion</strong>: Converts to/from string representation</li>
<li><strong>Design-Time Display</strong>: Shows meaningful text in property grid</li>
<li><strong>Serialization Support</strong>: Enables proper serialization in designer</li>
</ul>
<h2 id="testing">Testing</h2>
<h3 id="test-form">Test Form</h3>
<p>A comprehensive test form is available at:
<code>Source/Krypton Components/TestForm/ThemedSystemMenuTest.cs</code></p>
<h3 id="test-scenarios">Test Scenarios</h3>
<ol>
<li><strong>Basic Functionality</strong>: Verify menu appears and standard items work</li>
<li><strong>Trigger Methods</strong>: Test left-click, right-click, and Alt+Space triggers</li>
<li><strong>Custom Items</strong>: Add and test custom menu items</li>
<li><strong>Theme Changes</strong>: Verify icons update when theme changes</li>
<li><strong>Window States</strong>: Test menu behavior in different window states</li>
<li><strong>Error Handling</strong>: Test behavior with invalid inputs</li>
</ol>
<h3 id="manual-testing-steps">Manual Testing Steps</h3>
<ol>
<li>Build the Krypton Toolkit project</li>
<li>Run the TestForm application</li>
<li>Navigate to &quot;Themed System Menu&quot; test</li>
<li>Test each trigger method:
<ul>
<li>Left-click on title bar</li>
<li>Right-click on title bar</li>
<li>Press Alt+Space</li>
</ul>
</li>
<li>Verify custom items work correctly</li>
<li>Test theme changes</li>
<li>Test different window states</li>
</ol>
<h2 id="benefits">Benefits</h2>
<h3 id="1-visual-consistency">1. Visual Consistency</h3>
<ul>
<li><strong>Theme Integration</strong>: Menu matches the overall application theme</li>
<li><strong>Modern Appearance</strong>: Contemporary look that matches user expectations</li>
<li><strong>Brand Consistency</strong>: Maintains application branding throughout</li>
</ul>
<h3 id="2-developer-experience">2. Developer Experience</h3>
<ul>
<li><strong>Easy Integration</strong>: Automatic integration with KryptonForm</li>
<li><strong>Flexible API</strong>: Multiple ways to customize and extend</li>
<li><strong>Design-Time Support</strong>: Full Visual Studio integration</li>
<li><strong>Comprehensive Documentation</strong>: Clear API documentation and examples</li>
</ul>
<h3 id="3-user-experience">3. User Experience</h3>
<ul>
<li><strong>Familiar Behavior</strong>: Works exactly like the native system menu</li>
<li><strong>Enhanced Functionality</strong>: Can be extended with custom actions</li>
<li><strong>Accessibility</strong>: Maintains accessibility features</li>
<li><strong>Performance</strong>: Fast and responsive</li>
</ul>
<h3 id="4-maintenance">4. Maintenance</h3>
<ul>
<li><strong>Future-Proof</strong>: Uses Windows system resources maintained by Microsoft</li>
<li><strong>Version Compatibility</strong>: Works across different Windows versions</li>
<li><strong>Localization</strong>: Automatically adapts to system language</li>
<li><strong>Updates</strong>: Benefits from Krypton Toolkit updates</li>
</ul>
<h2 id="future-enhancements">Future Enhancements</h2>
<h3 id="potential-improvements">Potential Improvements</h3>
<ol>
<li><strong>Icon Customization</strong>: Support for custom icons in menu items</li>
<li><strong>RTL Support</strong>: Right-to-left language support</li>
<li><strong>Accessibility</strong>: Enhanced accessibility features</li>
<li><strong>Animation</strong>: Smooth animations for menu appearance</li>
<li><strong>Templates</strong>: Custom menu item templates</li>
<li><strong>Commands</strong>: Integration with Krypton commands system</li>
</ol>
<h3 id="integration-opportunities">Integration Opportunities</h3>
<ol>
<li><strong>Message Box Integration</strong>: Use themed system menu in message dialogs</li>
<li><strong>Toolbar Integration</strong>: Consistent theming across all UI elements</li>
<li><strong>Menu Integration</strong>: Unified menu system across application</li>
<li><strong>Status Bar Integration</strong>: Consistent status indicators</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>The KryptonThemedSystemMenu API provides a comprehensive, flexible, and easy-to-use solution for creating themed system menus in Krypton Toolkit applications. With automatic integration, extensive customization options, and robust error handling, it offers developers the tools they need to create professional, consistent user interfaces while maintaining the familiar behavior users expect from system menus.</p>
<p>The implementation follows Krypton Toolkit best practices, provides excellent design-time support, and delivers a high-quality user experience that enhances application professionalism and usability.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Krypton Component Suite 2024
BSD 3-Clause License
Â© Component Factory Pty Ltd, 2006 - 2016, All rights reserved.</span> <span>Modifications by Peter Wagner (aka Wagnerp), Simon Coghlan (aka Smurf-IV), Giduac, Tobitege, Lesarndro, KamaniAR & Ahmed Abdelhameed et al. 2017 - 2025. All rights reserved. <a href="https://github.com/Krypton-Suite">https://github.com/Krypton-Suite</a></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
