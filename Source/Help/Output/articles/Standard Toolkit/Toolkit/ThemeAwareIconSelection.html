<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Theme-Aware Icon Selection | Krypton Standard Toolkit Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Theme-Aware Icon Selection | Krypton Standard Toolkit Documentation ">
    
    
      <link rel="shortcut icon" href="../../../Krypton.ico">
      <link rel="stylesheet" href="../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../toc.html">
      <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../Logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="theme-aware-icon-selection">Theme-Aware Icon Selection</h1>

<h2 id="overview">Overview</h2>
<p>The <code>ExtractIconFromImageres</code> method now supports <strong>theme-aware icon selection</strong>, allowing you to choose icons that match your application's visual theme rather than just the operating system. This creates a more cohesive and professional appearance by ensuring icons align with your chosen Krypton theme.</p>
<h2 id="new-feature-iconselectionstrategy">New Feature: IconSelectionStrategy</h2>
<h3 id="the-strategy-enum">The Strategy Enum</h3>
<pre><code class="lang-csharp">public enum IconSelectionStrategy
{
    /// &lt;summary&gt;Use OS-based icon selection (default behavior).&lt;/summary&gt;
    OSBased = 0,

    /// &lt;summary&gt;Use theme-based icon selection.&lt;/summary&gt;
    ThemeBased = 1
}
</code></pre>
<h3 id="theme-mapping">Theme Mapping</h3>
<p>When using <code>ThemeBased</code> strategy, icons are selected based on your current Krypton theme:</p>
<table>
<thead>
<tr>
<th>Theme Category</th>
<th>Windows Icon Style</th>
<th>Example Themes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Professional/Office 2007/Sparkle</strong></td>
<td>Windows Vista</td>
<td>ProfessionalSystem, Office2007Blue, SparkleBlue</td>
</tr>
<tr>
<td><strong>Office 2010/2013</strong></td>
<td>Windows 7/8.x</td>
<td>Office2010Blue, Office2013White, VisualStudio2010Render2010</td>
</tr>
<tr>
<td><strong>Microsoft 365/Material</strong></td>
<td>Windows 10/11</td>
<td>Microsoft365Blue, MaterialLight, MaterialDark</td>
</tr>
</tbody>
</table>
<h2 id="usage-examples">Usage Examples</h2>
<h3 id="basic-theme-aware-usage">Basic Theme-Aware Usage</h3>
<pre><code class="lang-csharp">// Use theme-based icon selection
var shieldIcon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.ThemeBased
);
</code></pre>
<h3 id="comparison-os-based-vs-theme-based">Comparison: OS-Based vs Theme-Based</h3>
<pre><code class="lang-csharp">// OS-based selection (default)
var osBasedIcon = GraphicsExtensions.ExtractIconFromImageres((int)PI.ImageresIconID.Shield);

// Theme-based selection
var themeBasedIcon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.ThemeBased
);
</code></pre>
<h2 id="theme-compatibility-guide">Theme Compatibility Guide</h2>
<h3 id="windows-vista-compatible-themes">Windows Vista Compatible Themes</h3>
<p>These themes use Windows Vista-style icons for a classic, professional look:</p>
<pre><code class="lang-csharp">// Professional themes
PaletteMode.ProfessionalSystem
PaletteMode.ProfessionalOffice2003

// Office 2007 themes
PaletteMode.Office2007Blue
PaletteMode.Office2007BlueDarkMode
PaletteMode.Office2007BlueLightMode
PaletteMode.Office2007Silver
PaletteMode.Office2007SilverDarkMode
PaletteMode.Office2007SilverLightMode
PaletteMode.Office2007White
PaletteMode.Office2007Black
PaletteMode.Office2007BlackDarkMode

// Sparkle themes
PaletteMode.SparkleBlue
PaletteMode.SparkleBlueDarkMode
PaletteMode.SparkleBlueLightMode
PaletteMode.SparkleOrange
PaletteMode.SparkleOrangeDarkMode
PaletteMode.SparkleOrangeLightMode
PaletteMode.SparklePurple
PaletteMode.SparklePurpleDarkMode
PaletteMode.SparklePurpleLightMode
</code></pre>
<h3 id="windows-78x-compatible-themes">Windows 7/8.x Compatible Themes</h3>
<p>These themes use Windows 7/8.x-style icons for a modern, refined appearance:</p>
<pre><code class="lang-csharp">// Office 2010 themes
PaletteMode.Office2010Blue
PaletteMode.Office2010BlueDarkMode
PaletteMode.Office2010BlueLightMode
PaletteMode.Office2010Silver
PaletteMode.Office2010SilverDarkMode
PaletteMode.Office2010SilverLightMode
PaletteMode.Office2010White
PaletteMode.Office2010Black
PaletteMode.Office2010BlackDarkMode

// Office 2013 themes
PaletteMode.Office2013White

// Visual Studio 2010 themes
PaletteMode.VisualStudio2010Render2007
PaletteMode.VisualStudio2010Render2010
PaletteMode.VisualStudio2010Render2013
PaletteMode.VisualStudio2010Render365
</code></pre>
<h3 id="windows-1011-compatible-themes">Windows 10/11 Compatible Themes</h3>
<p>These themes use Windows 10/11-style icons for a contemporary, sleek appearance:</p>
<pre><code class="lang-csharp">// Microsoft 365 themes
PaletteMode.Microsoft365Blue
PaletteMode.Microsoft365BlueDarkMode
PaletteMode.Microsoft365BlueLightMode
PaletteMode.Microsoft365Silver
PaletteMode.Microsoft365SilverDarkMode
PaletteMode.Microsoft365SilverLightMode
PaletteMode.Microsoft365White
PaletteMode.Microsoft365Black
PaletteMode.Microsoft365BlackDarkMode
PaletteMode.Microsoft365BlackDarkModeAlternate

// Material themes
PaletteMode.MaterialLight
PaletteMode.MaterialDark
PaletteMode.MaterialLightRipple
PaletteMode.MaterialDarkRipple
</code></pre>
<h2 id="practical-implementation-examples">Practical Implementation Examples</h2>
<h3 id="1-theme-aware-button-creation">1. Theme-Aware Button Creation</h3>
<pre><code class="lang-csharp">public class ThemeAwareButton : KryptonButton
{
    public ThemeAwareButton()
    {
        // Automatically use theme-appropriate shield icon
        var shieldIcon = GraphicsExtensions.ExtractIconFromImageres(
            (int)PI.ImageresIconID.Shield, 
            IconSize.Small, 
            IconSelectionStrategy.ThemeBased
        );
        
        if (shieldIcon != null)
        {
            Image = shieldIcon.ToBitmap();
            shieldIcon.Dispose();
        }
    }
}
</code></pre>
<h3 id="2-dynamic-icon-updates-on-theme-change">2. Dynamic Icon Updates on Theme Change</h3>
<pre><code class="lang-csharp">public class ThemeAwareIconManager
{
    private readonly Dictionary&lt;IconSize, Image&gt; _iconCache = new();
    
    public ThemeAwareIconManager()
    {
        // Listen for theme changes
        KryptonManager.GlobalPaletteChanged += OnThemeChanged;
    }
    
    private void OnThemeChanged(object? sender, EventArgs e)
    {
        // Clear cache when theme changes
        _iconCache.Clear();
    }
    
    public Image? GetShieldIcon(IconSize size)
    {
        if (!_iconCache.ContainsKey(size))
        {
            var icon = GraphicsExtensions.ExtractIconFromImageres(
                (int)PI.ImageresIconID.Shield, 
                size, 
                IconSelectionStrategy.ThemeBased
            );
            
            if (icon != null)
            {
                _iconCache[size] = icon.ToBitmap();
                icon.Dispose();
            }
        }
        
        return _iconCache[size];
    }
}
</code></pre>
<h3 id="3-application-wide-icon-strategy">3. Application-Wide Icon Strategy</h3>
<pre><code class="lang-csharp">public static class IconStrategyManager
{
    private static IconSelectionStrategy _currentStrategy = IconSelectionStrategy.OSBased;
    
    public static IconSelectionStrategy CurrentStrategy
    {
        get =&gt; _currentStrategy;
        set
        {
            if (_currentStrategy != value)
            {
                _currentStrategy = value;
                OnStrategyChanged();
            }
        }
    }
    
    public static Icon? GetShieldIcon(IconSize size = IconSize.Medium)
    {
        return GraphicsExtensions.ExtractIconFromImageres(
            (int)PI.ImageresIconID.Shield, 
            size, 
            _currentStrategy
        );
    }
    
    private static void OnStrategyChanged()
    {
        // Notify UI components to refresh their icons
        // Implementation depends on your application architecture
    }
}
</code></pre>
<h2 id="real-world-scenarios">Real-World Scenarios</h2>
<h3 id="scenario-1-professional-application-with-office-2007-theme">Scenario 1: Professional Application with Office 2007 Theme</h3>
<pre><code class="lang-csharp">// User selects Office 2007 Blue theme
KryptonManager.GlobalPaletteMode = PaletteMode.Office2007Blue;

// Icons automatically use Windows Vista style
var shieldIcon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.ThemeBased
);
// Result: Windows Vista shield icon
</code></pre>
<h3 id="scenario-2-modern-application-with-microsoft-365-theme">Scenario 2: Modern Application with Microsoft 365 Theme</h3>
<pre><code class="lang-csharp">// User selects Microsoft 365 Blue theme
KryptonManager.GlobalPaletteMode = PaletteMode.Microsoft365Blue;

// Icons automatically use Windows 10/11 style
var shieldIcon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.ThemeBased
);
// Result: Windows 10/11 shield icon (depending on OS)
</code></pre>
<h3 id="scenario-3-development-tool-with-visual-studio-theme">Scenario 3: Development Tool with Visual Studio Theme</h3>
<pre><code class="lang-csharp">// User selects Visual Studio 2010 with Office 2010 renderer
KryptonManager.GlobalPaletteMode = PaletteMode.VisualStudio2010Render2010;

// Icons automatically use Windows 7/8.x style
var shieldIcon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.ThemeBased
);
// Result: Windows 7/8.x shield icon
</code></pre>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-choose-the-right-strategy">1. Choose the Right Strategy</h3>
<pre><code class="lang-csharp">// Use OS-based for system utilities
if (isSystemUtility)
{
    return GraphicsExtensions.ExtractIconFromImageres(
        (int)PI.ImageresIconID.Shield, 
        size, 
        IconSelectionStrategy.OSBased
    );
}

// Use theme-based for custom applications
else
{
    return GraphicsExtensions.ExtractIconFromImageres(
        (int)PI.ImageresIconID.Shield, 
        size, 
        IconSelectionStrategy.ThemeBased
    );
}
</code></pre>
<h3 id="2-cache-icons-appropriately">2. Cache Icons Appropriately</h3>
<pre><code class="lang-csharp">public class IconCache
{
    private static readonly Dictionary&lt;(IconSize, IconSelectionStrategy), Image&gt; _cache = new();
    
    public static Image? GetCachedIcon(IconSize size, IconSelectionStrategy strategy)
    {
        var key = (size, strategy);
        
        if (!_cache.ContainsKey(key))
        {
            var icon = GraphicsExtensions.ExtractIconFromImageres(
                (int)PI.ImageresIconID.Shield, 
                size, 
                strategy
            );
            
            if (icon != null)
            {
                _cache[key] = icon.ToBitmap();
                icon.Dispose();
            }
        }
        
        return _cache[key];
    }
    
    public static void ClearCache()
    {
        foreach (var image in _cache.Values)
        {
            image?.Dispose();
        }
        _cache.Clear();
    }
}
</code></pre>
<h3 id="3-handle-theme-changes-gracefully">3. Handle Theme Changes Gracefully</h3>
<pre><code class="lang-csharp">public class ThemeAwareForm : KryptonForm
{
    private readonly List&lt;Control&gt; _iconControls = new();
    
    public ThemeAwareForm()
    {
        KryptonManager.GlobalPaletteChanged += OnThemeChanged;
    }
    
    private void OnThemeChanged(object? sender, EventArgs e)
    {
        // Refresh all icon controls
        foreach (var control in _iconControls)
        {
            RefreshControlIcon(control);
        }
    }
    
    private void RefreshControlIcon(Control control)
    {
        if (control is KryptonButton button &amp;&amp; button.Tag?.ToString() == &quot;ShieldIcon&quot;)
        {
            var icon = GraphicsExtensions.ExtractIconFromImageres(
                (int)PI.ImageresIconID.Shield, 
                IconSize.Small, 
                IconSelectionStrategy.ThemeBased
            );
            
            if (icon != null)
            {
                button.Image = icon.ToBitmap();
                icon.Dispose();
            }
        }
    }
}
</code></pre>
<h2 id="performance-considerations">Performance Considerations</h2>
<h3 id="1-lazy-loading">1. Lazy Loading</h3>
<pre><code class="lang-csharp">public class LazyIconProvider
{
    private Image? _cachedIcon;
    private IconSize _cachedSize;
    private IconSelectionStrategy _cachedStrategy;
    private PaletteMode _cachedTheme;
    
    public Image? GetIcon(IconSize size, IconSelectionStrategy strategy)
    {
        var currentTheme = KryptonManager.CurrentGlobalPaletteMode;
        
        // Check if we need to refresh the cache
        if (_cachedIcon == null || 
            _cachedSize != size || 
            _cachedStrategy != strategy || 
            _cachedTheme != currentTheme)
        {
            // Dispose old icon
            _cachedIcon?.Dispose();
            
            // Load new icon
            var icon = GraphicsExtensions.ExtractIconFromImageres(
                (int)PI.ImageresIconID.Shield, 
                size, 
                strategy
            );
            
            if (icon != null)
            {
                _cachedIcon = icon.ToBitmap();
                icon.Dispose();
                
                // Update cache metadata
                _cachedSize = size;
                _cachedStrategy = strategy;
                _cachedTheme = currentTheme;
            }
        }
        
        return _cachedIcon;
    }
}
</code></pre>
<h3 id="2-memory-management">2. Memory Management</h3>
<pre><code class="lang-csharp">public class IconManager : IDisposable
{
    private readonly Dictionary&lt;string, Image&gt; _iconCache = new();
    
    public Image? GetIcon(string key, IconSize size, IconSelectionStrategy strategy)
    {
        if (!_iconCache.ContainsKey(key))
        {
            var icon = GraphicsExtensions.ExtractIconFromImageres(
                (int)PI.ImageresIconID.Shield, 
                size, 
                strategy
            );
            
            if (icon != null)
            {
                _iconCache[key] = icon.ToBitmap();
                icon.Dispose();
            }
        }
        
        return _iconCache[key];
    }
    
    public void Dispose()
    {
        foreach (var image in _iconCache.Values)
        {
            image?.Dispose();
        }
        _iconCache.Clear();
    }
}
</code></pre>
<h2 id="migration-guide">Migration Guide</h2>
<h3 id="from-os-based-to-theme-based">From OS-Based to Theme-Based</h3>
<p>If you're updating existing code to use theme-aware icons:</p>
<pre><code class="lang-csharp">// Old code (OS-based only)
var icon = GraphicsExtensions.ExtractIconFromImageres((int)PI.ImageresIconID.Shield);

// New code (theme-aware)
var icon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.ThemeBased
);
</code></pre>
<h3 id="backward-compatibility">Backward Compatibility</h3>
<p>The new parameter is optional, so existing code continues to work:</p>
<pre><code class="lang-csharp">// This still works (uses OS-based selection)
var icon = GraphicsExtensions.ExtractIconFromImageres((int)PI.ImageresIconID.Shield);

// This also works (explicit OS-based selection)
var icon = GraphicsExtensions.ExtractIconFromImageres(
    (int)PI.ImageresIconID.Shield, 
    IconSize.Medium, 
    IconSelectionStrategy.OSBased
);
</code></pre>
<h2 id="benefits">Benefits</h2>
<h3 id="1-visual-consistency">1. Visual Consistency</h3>
<ul>
<li>Icons match your application's theme</li>
<li>Professional, cohesive appearance</li>
<li>Better user experience</li>
</ul>
<h3 id="2-flexibility">2. Flexibility</h3>
<ul>
<li>Choose between OS-based and theme-based selection</li>
<li>Automatic adaptation to theme changes</li>
<li>Backward compatibility maintained</li>
</ul>
<h3 id="3-performance">3. Performance</h3>
<ul>
<li>Efficient caching strategies</li>
<li>Lazy loading support</li>
<li>Memory management best practices</li>
</ul>
<h3 id="4-developer-experience">4. Developer Experience</h3>
<ul>
<li>Simple API with optional parameters</li>
<li>Clear theme mapping documentation</li>
<li>Comprehensive examples and best practices</li>
</ul>
<h2 id="summary">Summary</h2>
<p>The theme-aware icon selection feature provides:</p>
<ul>
<li><strong>Automatic icon matching</strong> to your Krypton theme</li>
<li><strong>Flexible selection strategy</strong> (OS-based or theme-based)</li>
<li><strong>Seamless integration</strong> with existing code</li>
<li><strong>Performance optimization</strong> through caching</li>
<li><strong>Professional appearance</strong> that enhances user experience</li>
</ul>
<p>This feature ensures your application's icons always look professional and consistent with your chosen theme, creating a more polished and cohesive user interface.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Krypton Component Suite 2024
BSD 3-Clause License
Â© Component Factory Pty Ltd, 2006 - 2016, All rights reserved.</span> <span>Modifications by Peter Wagner (aka Wagnerp), Simon Coghlan (aka Smurf-IV), Giduac, Tobitege, Lesarndro, KamaniAR & Ahmed Abdelhameed et al. 2017 - 2025. All rights reserved. <a href="https://github.com/Krypton-Suite">https://github.com/Krypton-Suite</a></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
