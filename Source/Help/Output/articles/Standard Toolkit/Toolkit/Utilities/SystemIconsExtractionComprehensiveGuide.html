<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Comprehensive Guide to Windows System Icon Extraction | Krypton Standard Toolkit Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Comprehensive Guide to Windows System Icon Extraction | Krypton Standard Toolkit Documentation ">
    
    
      <link rel="shortcut icon" href="../../../../Krypton.ico">
      <link rel="stylesheet" href="../../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../../toc.html">
      <meta property="docfx:tocrel" content="../../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../Logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="comprehensive-guide-to-windows-system-icon-extraction">Comprehensive Guide to Windows System Icon Extraction</h1>

<p>The Krypton Toolkit now provides access to <strong>1500+ Windows system icons</strong> from multiple DLLs across the Windows operating system.</p>
<h2 id="overview-of-icon-sources">Overview of Icon Sources</h2>
<table>
<thead>
<tr>
<th>DLL</th>
<th>Approx. Icons</th>
<th>Description</th>
<th>Enum</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>imageres.dll</strong></td>
<td>~300</td>
<td>Modern Windows icons (Vista+)</td>
<td><code>ImageresIconID</code></td>
<td><code>ExtractIconFromImageres()</code></td>
</tr>
<tr>
<td><strong>shell32.dll</strong></td>
<td>~300</td>
<td>Classic Windows shell icons</td>
<td><code>Shell32IconID</code></td>
<td><code>ExtractIconFromShell32()</code></td>
</tr>
<tr>
<td><strong>ieframe.dll</strong></td>
<td>~200</td>
<td>Internet Explorer &amp; web icons</td>
<td><code>IeFrameIconID</code></td>
<td><code>ExtractIconFromIeFrame()</code></td>
</tr>
<tr>
<td><strong>moricons.dll</strong></td>
<td>~100</td>
<td>Miscellaneous system icons</td>
<td><code>MoreIconsIconID</code></td>
<td><code>ExtractIconFromMoreIcons()</code></td>
</tr>
<tr>
<td><strong>compstui.dll</strong></td>
<td>~100</td>
<td>Printer &amp; device UI icons</td>
<td><code>CompStuiIconID</code></td>
<td><code>ExtractIconFromCompStui()</code></td>
</tr>
<tr>
<td><strong>setupapi.dll</strong></td>
<td>~60</td>
<td>Setup &amp; device icons</td>
<td><code>SetupApiIconID</code></td>
<td><code>ExtractIconFromSetupApi()</code></td>
</tr>
<tr>
<td><strong>netshell.dll</strong></td>
<td>~40</td>
<td>Network connection icons</td>
<td><code>NetShellIconID</code></td>
<td><code>ExtractIconFromNetShell()</code></td>
</tr>
<tr>
<td><strong>TOTAL</strong></td>
<td><strong>~1500+</strong></td>
<td>Complete system icon coverage</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="quick-start-examples">Quick Start Examples</h2>
<h3 id="1-imageresdll---modern-system-icons">1. imageres.dll - Modern System Icons</h3>
<pre><code class="lang-csharp">// Extract UAC shield
var shield = GraphicsExtensions.ExtractIconFromImageres(
    (int)ImageresIconID.Shield, 
    IconSize.Large
);

// Extract lock icon
var lock = GraphicsExtensions.ExtractIconFromImageres(
    (int)ImageresIconID.Lock, 
    IconSize.Medium
);
</code></pre>
<h3 id="2-shell32dll---classic-shell-icons">2. shell32.dll - Classic Shell Icons</h3>
<pre><code class="lang-csharp">// Extract folder icon
var folder = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Folder, 
    IconSize.ExtraLarge
);

// Extract recycle bin
var recycleBin = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.RecycleBinEmpty, 
    IconSize.Medium
);

// Extract computer icon
var computer = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Computer, 
    IconSize.Large
);
</code></pre>
<h3 id="3-ieframedll---internet-explorer-icons">3. ieframe.dll - Internet Explorer Icons</h3>
<pre><code class="lang-csharp">// Extract Internet Explorer icon
var ie = GraphicsExtensions.ExtractIconFromIeFrame(
    (int)IeFrameIconID.InternetExplorer, 
    IconSize.Medium
);

// Extract download icon
var download = GraphicsExtensions.ExtractIconFromIeFrame(
    (int)IeFrameIconID.Download, 
    IconSize.Small
);

// Extract secure connection icon
var ssl = GraphicsExtensions.ExtractIconFromIeFrame(
    (int)IeFrameIconID.SecureConnection, 
    IconSize.Medium
);
</code></pre>
<h3 id="4-moriconsdll---miscellaneous-icons">4. moricons.dll - Miscellaneous Icons</h3>
<pre><code class="lang-csharp">// Extract MS-DOS icon
var dos = GraphicsExtensions.ExtractIconFromMoreIcons(
    (int)MoreIconsIconID.MsDosIcon, 
    IconSize.Medium
);

// Extract archive icon
var archive = GraphicsExtensions.ExtractIconFromMoreIcons(
    (int)MoreIconsIconID.ArchiveFile, 
    IconSize.Small
);
</code></pre>
<h3 id="5-compstuidll---printer--device-icons">5. compstui.dll - Printer &amp; Device Icons</h3>
<pre><code class="lang-csharp">// Extract printer icon
var printer = GraphicsExtensions.ExtractIconFromCompStui(
    (int)CompStuiIconID.Printer, 
    IconSize.Large
);

// Extract color settings icon
var color = GraphicsExtensions.ExtractIconFromCompStui(
    (int)CompStuiIconID.Color, 
    IconSize.Medium
);
</code></pre>
<h3 id="6-setupapidll---hardware--setup-icons">6. setupapi.dll - Hardware &amp; Setup Icons</h3>
<pre><code class="lang-csharp">// Extract hardware device icon
var device = GraphicsExtensions.ExtractIconFromSetupApi(
    (int)SetupApiIconID.HardwareDevice, 
    IconSize.Medium
);

// Extract USB device icon
var usb = GraphicsExtensions.ExtractIconFromSetupApi(
    (int)SetupApiIconID.UsbDevice, 
    IconSize.Large
);
</code></pre>
<h3 id="7-netshelldll---network-icons">7. netshell.dll - Network Icons</h3>
<pre><code class="lang-csharp">// Extract network connection icon
var network = GraphicsExtensions.ExtractIconFromNetShell(
    (int)NetShellIconID.NetworkConnection, 
    IconSize.Medium
);

// Extract wireless network icon
var wifi = GraphicsExtensions.ExtractIconFromNetShell(
    (int)NetShellIconID.WirelessNetwork, 
    IconSize.Large
);

// Extract VPN icon
var vpn = GraphicsExtensions.ExtractIconFromNetShell(
    (int)NetShellIconID.VpnConnection, 
    IconSize.Medium
);
</code></pre>
<h2 id="accessing-undocumented-icons">Accessing Undocumented Icons</h2>
<p>Each DLL may contain more icons than are documented in the enums. You can access any icon by index:</p>
<pre><code class="lang-csharp">// Access shell32.dll icon at index 250
var customIcon1 = GraphicsExtensions.ExtractIconFromShell32(250, IconSize.Medium);

// Access ieframe.dll icon at index 50
var customIcon2 = GraphicsExtensions.ExtractIconFromIeFrame(50, IconSize.Large);

// Access any DLL directly
var customIcon3 = GraphicsExtensions.ExtractIcon(@&quot;C:\Windows\System32\mydll.dll&quot;, 10, largeIcon: true);
</code></pre>
<h2 id="using-icons-in-your-application">Using Icons in Your Application</h2>
<h3 id="with-krypton-buttons">With Krypton Buttons</h3>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Folder, 
    IconSize.Medium
);

if (icon != null)
{
    kryptonButton1.Values.Image = icon.ToBitmap();
    kryptonButton1.Values.Text = &quot;Open Folder&quot;;
}
</code></pre>
<h3 id="with-picture-boxes">With Picture Boxes</h3>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIconFromNetShell(
    (int)NetShellIconID.WirelessNetwork, 
    IconSize.ExtraLarge
);

if (icon != null)
{
    pictureBox1.Image = icon.ToBitmap();
}
</code></pre>
<h3 id="creating-an-image-list">Creating an Image List</h3>
<pre><code class="lang-csharp">var imageList = new ImageList();
imageList.ImageSize = new Size(32, 32);

// Add icons from multiple sources
var icons = new[]
{
    GraphicsExtensions.ExtractIconFromShell32((int)Shell32IconID.Folder, IconSize.Medium),
    GraphicsExtensions.ExtractIconFromShell32((int)Shell32IconID.Computer, IconSize.Medium),
    GraphicsExtensions.ExtractIconFromNetShell((int)NetShellIconID.NetworkConnection, IconSize.Medium),
    GraphicsExtensions.ExtractIconFromIeFrame((int)IeFrameIconID.InternetExplorer, IconSize.Medium),
};

foreach (var icon in icons)
{
    if (icon != null)
    {
        imageList.Images.Add(icon.ToBitmap());
        icon.Dispose(); // Remember to dispose icons when done
    }
}

// Use with TreeView, ListView, etc.
treeView1.ImageList = imageList;
</code></pre>
<h2 id="icon-categories-by-dll">Icon Categories by DLL</h2>
<h3 id="imageresdll-categories">imageres.dll Categories</h3>
<ul>
<li>System security (shields, locks, keys)</li>
<li>User accounts</li>
<li>Files and folders</li>
<li>Media (audio, video, images)</li>
<li>Devices (computers, printers, cameras)</li>
<li>Actions (copy, paste, delete)</li>
<li>Applications and tools</li>
</ul>
<h3 id="shell32dll-categories">shell32.dll Categories</h3>
<ul>
<li>Basic files and folders (0-4)</li>
<li>Drives and storage (5-12)</li>
<li>Network and computers (13-21)</li>
<li>System utilities (22-44)</li>
<li>Hardware and devices (45-99)</li>
<li>Media and entertainment (100-119)</li>
<li>Internet and communication (120-149)</li>
<li>System folders (150-179)</li>
<li>Actions and operations (160-189)</li>
<li>User accounts (220-234)</li>
<li>Windows features (240-269)</li>
</ul>
<h3 id="ieframedll-categories">ieframe.dll Categories</h3>
<ul>
<li>Browser navigation</li>
<li>Favorites and bookmarks</li>
<li>Security and privacy</li>
<li>Download/upload</li>
<li>Web feeds</li>
<li>Internet settings</li>
</ul>
<h3 id="moriconsdll-categories">moricons.dll Categories</h3>
<ul>
<li>Legacy DOS/Windows icons</li>
<li>Document types</li>
<li>Archive files</li>
<li>Database icons</li>
<li>Media files</li>
</ul>
<h3 id="compstuidll-categories">compstui.dll Categories</h3>
<ul>
<li>Printer icons</li>
<li>Print settings</li>
<li>Device configuration</li>
<li>UI components</li>
</ul>
<h3 id="setupapidll-categories">setupapi.dll Categories</h3>
<ul>
<li>Hardware devices</li>
<li>Device drivers</li>
<li>System devices</li>
<li>Installation icons</li>
</ul>
<h3 id="netshelldll-categories">netshell.dll Categories</h3>
<ul>
<li>Network connections</li>
<li>Wireless networks</li>
<li>VPN connections</li>
<li>Network settings</li>
<li>Firewall icons</li>
</ul>
<h2 id="icon-size-reference">Icon Size Reference</h2>
<pre><code class="lang-csharp">IconSize.Tiny          // 8x8
IconSize.ExtraSmall    // 16x16
IconSize.Small         // 20x20
IconSize.MediumSmall   // 24x24
IconSize.Medium        // 32x32 (default)
IconSize.Large         // 48x48
IconSize.ExtraLarge    // 64x64
IconSize.Jumbo         // 96x96
IconSize.ExtraJumbo    // 128x128
IconSize.Huge          // 256x256
</code></pre>
<h2 id="error-handling-best-practices">Error Handling Best Practices</h2>
<p>Always check for null returns as icons may not be available on all Windows versions:</p>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Folder, 
    IconSize.Medium
);

if (icon != null)
{
    try
    {
        // Use the icon
        myButton.Values.Image = icon.ToBitmap();
    }
    finally
    {
        // Dispose when done
        icon.Dispose();
    }
}
else
{
    // Use a fallback icon or embedded resource
    myButton.Values.Image = Properties.Resources.FallbackIcon;
}
</code></pre>
<h2 id="performance-tips">Performance Tips</h2>
<ol>
<li><strong>Cache extracted icons</strong> if you're using them multiple times</li>
<li><strong>Dispose of icons</strong> when no longer needed to free resources</li>
<li><strong>Extract icons once</strong> during initialization, not on every render</li>
<li><strong>Use appropriate sizes</strong> - don't extract 256x256 if you only need 16x16</li>
</ol>
<pre><code class="lang-csharp">// Cache icons at startup
private Icon? _folderIcon;

public void InitializeIcons()
{
    _folderIcon = GraphicsExtensions.ExtractIconFromShell32(
        (int)Shell32IconID.Folder, 
        IconSize.Medium
    );
}

public void Cleanup()
{
    _folderIcon?.Dispose();
}
</code></pre>
<h2 id="windows-version-compatibility">Windows Version Compatibility</h2>
<ul>
<li><strong>imageres.dll</strong>: Windows Vista and later</li>
<li><strong>shell32.dll</strong>: All Windows versions (95+)</li>
<li><strong>ieframe.dll</strong>: Windows XP and later (varies by IE version)</li>
<li><strong>moricons.dll</strong>: Windows 95 and later</li>
<li><strong>compstui.dll</strong>: Windows 2000 and later</li>
<li><strong>setupapi.dll</strong>: Windows 2000 and later</li>
<li><strong>netshell.dll</strong>: Windows XP and later</li>
</ul>
<p>Icon appearance and availability may vary across Windows versions. Test on your target platforms.</p>
<h2 id="complete-example-application">Complete Example Application</h2>
<p>See <code>IconExtractionTest.cs</code> in the TestForm project for a complete working example demonstrating icon extraction from multiple DLLs.</p>
<h2 id="summary">Summary</h2>
<p>You now have access to <strong>1500+ Windows system icons</strong> across 7 different DLLs:</p>
<ul>
<li>✅ imageres.dll (~300 icons)</li>
<li>✅ shell32.dll (~300 icons)</li>
<li>✅ ieframe.dll (~200 icons)</li>
<li>✅ moricons.dll (~100 icons)</li>
<li>✅ compstui.dll (~100 icons)</li>
<li>✅ setupapi.dll (~60 icons)</li>
<li>✅ netshell.dll (~40 icons)</li>
</ul>
<p>Each DLL provides specialized icons for different system functions, giving you comprehensive access to the Windows icon library without needing to embed custom resources.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Krypton Component Suite 2024
BSD 3-Clause License
© Component Factory Pty Ltd, 2006 - 2016, All rights reserved.</span> <span>Modifications by Peter Wagner (aka Wagnerp), Simon Coghlan (aka Smurf-IV), Giduac, Tobitege, Lesarndro, KamaniAR & Ahmed Abdelhameed et al. 2017 - 2025. All rights reserved. <a href="https://github.com/Krypton-Suite">https://github.com/Krypton-Suite</a></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
