<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Icon Extraction API - Quick Reference | Krypton Standard Toolkit Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Icon Extraction API - Quick Reference | Krypton Standard Toolkit Documentation ">
    
    
      <link rel="shortcut icon" href="../../../../Krypton.ico">
      <link rel="stylesheet" href="../../../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../../../styles/docfx.css">
      <link rel="stylesheet" href="../../../../styles/main.css">
      <meta property="docfx:navrel" content="../../../../toc.html">
      <meta property="docfx:tocrel" content="../../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../Logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="icon-extraction-api---quick-reference">Icon Extraction API - Quick Reference</h1>

<h2 id="one-page-cheat-sheet">One-Page Cheat Sheet</h2>
<h3 id="-available-icon-sources">üì¶ Available Icon Sources</h3>
<pre><code class="lang-csharp">imageres.dll    ‚Üí  ExtractIconFromImageres()   // 300+ modern icons (Vista+)
shell32.dll     ‚Üí  ExtractIconFromShell32()    // 300+ classic icons (Win95+)
ieframe.dll     ‚Üí  ExtractIconFromIeFrame()    // 200+ browser icons (XP+)
moricons.dll    ‚Üí  ExtractIconFromMoreIcons()  // 100+ legacy icons (Win95+)
compstui.dll    ‚Üí  ExtractIconFromCompStui()   // 100+ printer icons (Win2K+)
setupapi.dll    ‚Üí  ExtractIconFromSetupApi()   // 60+ hardware icons (Win2K+)
netshell.dll    ‚Üí  ExtractIconFromNetShell()   // 40+ network icons (XP+)
</code></pre>
<hr>
<h3 id="-basic-usage">üéØ Basic Usage</h3>
<pre><code class="lang-csharp">// Extract icon from shell32.dll
var icon = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Folder, 
    IconSize.Medium
);

if (icon != null)
{
    myButton.Values.Image = icon.ToBitmap();
}
</code></pre>
<hr>
<h3 id="-icon-sizes">üìè Icon Sizes</h3>
<pre><code class="lang-csharp">IconSize.Tiny          // 8√ó8
IconSize.ExtraSmall    // 16√ó16
IconSize.Small         // 20√ó20
IconSize.MediumSmall   // 24√ó24
IconSize.Medium        // 32√ó32  ‚≠ê Default
IconSize.Large         // 48√ó48
IconSize.ExtraLarge    // 64√ó64
IconSize.Jumbo         // 96√ó96
IconSize.ExtraJumbo    // 128√ó128
IconSize.Huge          // 256√ó256
</code></pre>
<hr>
<h3 id="-common-icon-ids">üîë Common Icon IDs</h3>
<h4 id="from-shell32dll">From Shell32.dll</h4>
<pre><code class="lang-csharp">Shell32IconID.Folder              // 3   - Closed folder
Shell32IconID.FolderOpen          // 4   - Open folder
Shell32IconID.Computer            // 15  - Computer/PC
Shell32IconID.HardDrive           // 8   - Hard disk
Shell32IconID.Network             // 18  - Network
Shell32IconID.Printer             // 16  - Printer
Shell32IconID.RecycleBinEmpty     // 31  - Empty recycle bin
Shell32IconID.RecycleBinFull      // 32  - Full recycle bin
Shell32IconID.Search              // 22  - Search/Find
Shell32IconID.Help                // 23  - Help/Question
Shell32IconID.Run                 // 24  - Run/Execute
Shell32IconID.Delete              // 161 - Delete
Shell32IconID.Properties          // 165 - Properties
</code></pre>
<h4 id="from-imageresdll">From Imageres.dll</h4>
<pre><code class="lang-csharp">ImageresIconID.Shield             // 78  - UAC shield
ImageresIconID.Lock               // 48  - Lock/Security
ImageresIconID.User               // 51  - User account
ImageresIconID.Key                // 50  - Key/Password
</code></pre>
<h4 id="from-netshelldll">From NetShell.dll</h4>
<pre><code class="lang-csharp">NetShellIconID.NetworkConnection  // 0   - Network connection
NetShellIconID.WirelessNetwork    // 3   - WiFi
NetShellIconID.VpnConnection      // 8   - VPN
</code></pre>
<hr>
<h3 id="-quick-examples">üí° Quick Examples</h3>
<h4 id="extract-by-enum">Extract by Enum</h4>
<pre><code class="lang-csharp">var folder = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Folder, 
    IconSize.Large
);
</code></pre>
<h4 id="extract-by-index">Extract by Index</h4>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIconFromShell32(16805, IconSize.Medium);
</code></pre>
<h4 id="extract-from-any-dll">Extract from Any DLL</h4>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIcon(&quot;mydll.dll&quot;, 42, largeIcon: true);
</code></pre>
<hr>
<h3 id="-best-practices">‚úÖ Best Practices</h3>
<pre><code class="lang-csharp">// ‚úÖ GOOD: Check for null
var icon = GraphicsExtensions.ExtractIconFromShell32(3, IconSize.Medium);
if (icon != null)
{
    myButton.Values.Image = icon.ToBitmap();
}

// ‚úÖ GOOD: Cache frequently used icons
private Icon? _folderIcon;

public void Initialize()
{
    _folderIcon = GraphicsExtensions.ExtractIconFromShell32(
        (int)Shell32IconID.Folder, 
        IconSize.Medium
    );
}

// ‚úÖ GOOD: Dispose when done
protected override void Dispose(bool disposing)
{
    if (disposing)
    {
        _folderIcon?.Dispose();
    }
    base.Dispose(disposing);
}
</code></pre>
<hr>
<h3 id="-common-mistakes">‚ùå Common Mistakes</h3>
<pre><code class="lang-csharp">// ‚ùå BAD: Not checking for null
var icon = GraphicsExtensions.ExtractIconFromShell32(3, IconSize.Medium);
myButton.Values.Image = icon.ToBitmap(); // NullReferenceException!

// ‚ùå BAD: Extracting every time instead of caching
for (int i = 0; i &lt; 1000; i++)
{
    var icon = GraphicsExtensions.ExtractIconFromShell32(3, IconSize.Medium);
    // Use icon... (very inefficient!)
}

// ‚ùå BAD: Not disposing icons
for (int i = 0; i &lt; 1000; i++)
{
    var icon = GraphicsExtensions.ExtractIconFromShell32(i, IconSize.Medium);
    // Forgot to dispose - memory leak!
}
</code></pre>
<hr>
<h3 id="-common-patterns">üé® Common Patterns</h3>
<h4 id="with-krypton-button">With Krypton Button</h4>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIconFromShell32(
    (int)Shell32IconID.Folder, 
    IconSize.Medium
);

if (icon != null)
{
    kryptonButton1.Values.Image = icon.ToBitmap();
    kryptonButton1.Values.Text = &quot;Open Folder&quot;;
}
</code></pre>
<h4 id="with-picture-box">With Picture Box</h4>
<pre><code class="lang-csharp">var icon = GraphicsExtensions.ExtractIconFromNetShell(
    (int)NetShellIconID.WirelessNetwork, 
    IconSize.ExtraLarge
);

if (icon != null)
{
    kryptonPictureBox1.Image = icon.ToBitmap();
}
</code></pre>
<h4 id="with-image-list">With Image List</h4>
<pre><code class="lang-csharp">var imageList = new ImageList { ImageSize = new Size(32, 32) };

var icons = new[]
{
    Shell32IconID.Folder,
    Shell32IconID.Computer,
    Shell32IconID.Network
};

foreach (var iconId in icons)
{
    var icon = GraphicsExtensions.ExtractIconFromShell32(
        (int)iconId, 
        IconSize.Medium
    );
    
    if (icon != null)
    {
        imageList.Images.Add(icon.ToBitmap());
    }
}

treeView1.ImageList = imageList;
</code></pre>
<hr>
<h3 id="-troubleshooting">üîç Troubleshooting</h3>
<table>
<thead>
<tr>
<th>Problem</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>Returns <code>null</code></td>
<td>Icon doesn't exist at that index, or DLL not found</td>
</tr>
<tr>
<td>Wrong size</td>
<td>Use different <code>IconSize</code> value</td>
</tr>
<tr>
<td>Blurry icon</td>
<td>Extract at exact display size, don't scale</td>
</tr>
<tr>
<td>Memory leak</td>
<td>Remember to dispose icons when done</td>
</tr>
<tr>
<td>Slow performance</td>
<td>Cache icons, don't extract repeatedly</td>
</tr>
<tr>
<td>Icon looks different on other Windows</td>
<td>Icons vary by Windows version - test on target OS</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="-full-documentation">üìö Full Documentation</h3>
<ul>
<li><strong>API Reference</strong>: <a href="IconExtractionAPIReference.html">Icon Extraction API Reference</a></li>
<li><strong>User Guide</strong>: <a href="SystemIconsComprehensiveGuide.html">System Icons Comprehensive Guide</a></li>
<li><strong>Examples</strong>: <a href="IconExtractionExample.html">Icon Extraction Example</a></li>
</ul>
<hr>
<h3 id="-total-available-icons">üöÄ Total Available Icons</h3>
<pre><code>imageres.dll      300+
shell32.dll       300+
ieframe.dll       200+
moricons.dll      100+
compstui.dll      100+
setupapi.dll       60+
netshell.dll       40+
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
TOTAL:           1500+
</code></pre>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Krypton Component Suite 2024
BSD 3-Clause License
¬© Component Factory Pty Ltd, 2006 - 2016, All rights reserved.</span> <span>Modifications by Peter Wagner (aka Wagnerp), Simon Coghlan (aka Smurf-IV), Giduac, Tobitege, Lesarndro, KamaniAR & Ahmed Abdelhameed et al. 2017 - 2025. All rights reserved. <a href="https://github.com/Krypton-Suite">https://github.com/Krypton-Suite</a></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
